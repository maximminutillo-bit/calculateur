<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Couverture BACK (2 issues)</title>
  <meta name="description" content="Couverture BACK↔BACK – égalisation des gains (monochrome)">
  <meta name="color-scheme" content="dark light">
  <style>
    :root{--bg:#FAFAFA;--fg:#0A0A0A;--muted:#6B7280;--card:#FFFFFF;--border:#E5E7EB;--accent:#111;--ok:#16a34a;--warn:#b91c1c}
    .dark{--bg:#0A0A0A;--fg:#F5F5F5;--muted:#9CA3AF;--card:#111;--border:#27272A;--accent:#FFF}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font:14px ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{max-width:960px;margin:0 auto;padding:18px}
    h1{margin:0 0 8px;font-size:22px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
    label{display:block;margin:10px 0 6px}
    input{width:100%;font:inherit;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--fg);outline:none}
    input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,0,0,.07)}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{cursor:pointer;border:1px solid var(--fg);background:var(--fg);color:var(--bg);padding:10px 14px;border-radius:10px;font-weight:700}
    .btn.ghost{background:transparent;color:var(--fg)}
    .sub{color:var(--muted);margin:0 0 10px}
    .center{text-align:center}
    .msg{display:none;margin:12px auto 6px;max-width:520px;padding:8px 12px;border-radius:999px;font-weight:800}
    .ok{color:var(--ok);border:1px solid var(--ok)}
    .warn{color:var(--warn);border:1px solid var(--warn)}
    .muted{color:var(--muted);font-size:13px}
    table{width:100%;border-collapse:collapse;margin-top:14px;font-size:13px}
    th,td{border-top:1px solid var(--border);padding:10px 8px;text-align:left}
    tfoot td{border-top:1px solid var(--border);font-weight:700}
    .footer{margin-top:18px;text-align:center;color:var(--muted);font-size:12px}
    .nav{margin-bottom:10px}
    .nav a{color:inherit;text-decoration:none;border:1px solid var(--border);padding:6px 10px;border-radius:8px}
  </style>
</head>
<body class="dark">
  <div class="wrap">
    <div class="nav">
      <a href="index.html" class="pill">Convertisseur</a>
      <a href="monopoly.html" class="pill">Monopoly Lay Orbitx</a>
      <a href="couverture-back.html" class="pill active">Couverture BACK</a>
    </div>

    <h1>Couverture BACK (2 issues)</h1>
    <p class="sub">Égalise tes résultats en plaçant un <strong>BACK</strong> sur l’issue 1 (qualif) et un <strong>BACK</strong> de couverture sur l’issue 2.</p>

    <div class="card">
      <div class="grid2">
        <div>
          <label>Combien dois-tu jouer pour réaliser la promo (€) ?</label>
          <input id="s1" type="number" inputmode="decimal" step="0.01" min="0" value="50">
        </div>
        <div></div>
        <div>
          <label>Cote 1 (book A – pari qualif)</label>
          <input id="c1" type="number" inputmode="decimal" step="0.01" min="1.01" value="3.35">
        </div>
        <div>
          <label>Cote 2 (book B – couverture)</label>
          <input id="c2" type="number" inputmode="decimal" step="0.01" min="1.01" value="1.45">
        </div>
      </div>

      <div class="row">
        <button id="calc" class="btn" type="button">Calculer Promo</button>
        <button id="reset" class="btn ghost" type="button">Réinitialiser</button>
      </div>

      <div id="ratio-box" class="center" style="display:none; margin-top:10px">
        <span class="muted">Cote 1 ÷ Cote 2 = <strong id="ratio-value">0,0&nbsp;%</strong></span>
        <div id="ratio-status" style="margin-top:6px;font-weight:800"></div>
      </div>

      <div id="flag" class="msg center"></div>

      <div id="details" class="center" style="display:none">
        <p>La rentabilité égalisée est de <strong id="profit">0,00€</strong> !</p>
        <p class="muted"><em>
          Dans le détail, il faut jouer : <strong id="stake1">0,00€</strong> sur la <strong>Cote 1</strong> ;
          <strong id="stake2">0,00€</strong> sur la <strong>Cote 2</strong>.
        </em></p>

        <table>
          <thead>
            <tr><th>Issue</th><th>Cote</th><th>Mise</th><th>Résultat net</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>1 (Cote 1 gagne)</td>
              <td id="t_c1">–</td>
              <td id="t_s1">–</td>
              <td id="t_n1">–</td>
            </tr>
            <tr>
              <td>2 (Cote 2 gagne)</td>
              <td id="t_c2">–</td>
              <td id="t_s2">–</td>
              <td id="t_n2">–</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3">Net (égalisé)</td>
              <td id="t_net">–</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <div class="footer">© 2025 – Créé par <strong>Maxim Minutillo</strong> • <em>Ne pas partager</em></div>
  </div>

  <script>
    const fmtEUR = (n) => new Intl.NumberFormat('fr-FR', {style:'currency', currency:'EUR'}).format(n||0);
    const pct    = (n) => (n).toLocaleString('fr-FR', {minimumFractionDigits:1, maximumFractionDigits:1}) + " %";

    // Formules couverture BACK↔BACK (2 issues)
    // S1 sur C1, on cherche S2 sur C2 pour égaliser:
    //   S1*(C1-1) - S2  =  S2*(C2-1) - S1
    // => S2 = S1 * C1 / C2
    // Net égalisé = S1*(C1 - 1) - S2 = S1*(C1 - 1 - C1/C2)
    function compute(){
      const S1 = parseFloat(document.getElementById('s1').value.replace(',', '.')) || 0;
      const C1 = parseFloat(document.getElementById('c1').value.replace(',', '.')) || 0;
      const C2 = parseFloat(document.getElementById('c2').value.replace(',', '.')) || 0;

      // Ratio + statut
      if (C1 > 0 && C2 > 0){
        const r = (C1 / C2) * 100;
        document.getElementById('ratio-value').textContent = pct(r);
        const s = document.getElementById('ratio-status');
        if (r >= 95) s.textContent = "🔥 Superbe (≥ 95 %)";
        else if (r >= 90) s.textContent = "✅ Ok (≥ 90 %)";
        else s.textContent = "⛔ Pas rentable (< 90 %)";
        document.getElementById('ratio-box').style.display = "";
      } else {
        document.getElementById('ratio-box').style.display = "none";
      }

      if (!(S1>0 && C1>1 && C2>1)) return;

      const S2   = S1 * C1 / C2;
      const net1 = S1*(C1 - 1) - S2;     // si issue 1 gagne
      const net2 = S2*(C2 - 1) - S1;     // si issue 2 gagne
      const net  = Math.abs(net1 - net2) < 1e-6 ? net1 : (net1 + net2)/2;

      // Bandeau d’état
      const flag = document.getElementById('flag');
      flag.textContent = net >= 0 ? "✅ Bravo" : "⚠️ Attention";
      flag.className   = net >= 0 ? "msg ok center" : "msg warn center";
      flag.style.display = "";

      // Détails
      document.getElementById('profit').textContent = fmtEUR(net);
      document.getElementById('stake1').textContent = fmtEUR(S1);
      document.getElementById('stake2').textContent = fmtEUR(S2);

      document.getElementById('t_c1').textContent = C1.toFixed(2);
      document.getElementById('t_s1').textContent = fmtEUR(S1);
      document.getElementById('t_n1').textContent = fmtEUR(net1);

      document.getElementById('t_c2').textContent = C2.toFixed(2);
      document.getElementById('t_s2').textContent = fmtEUR(S2);
      document.getElementById('t_n2').textContent = fmtEUR(net2);

      document.getElementById('t_net').textContent = fmtEUR(net);
      document.getElementById('details').style.display = "";
      try { localStorage.setItem('backcover', JSON.stringify({S1,C1,C2})); } catch {}
    }

    document.getElementById('calc').addEventListener('click', compute);
    document.getElementById('reset').addEventListener('click', ()=>{
      ['s1','c1','c2'].forEach(id => document.getElementById(id).value = '');
      document.getElementById('flag').style.display = "none";
      document.getElementById('details').style.display = "none";
      document.getElementById('ratio-box').style.display = "none";
      try { localStorage.removeItem('backcover'); } catch {}
    });

    // Entrée → calcul
    ['s1','c1','c2'].forEach(id=>{
      document.getElementById(id).addEventListener('keydown', e=>{
        if(e.key==='Enter') document.getElementById('calc').click();
      });
    });

    // Restore
    try {
      const s = JSON.parse(localStorage.getItem('backcover')||'{}');
      if (s.S1) document.getElementById('s1').value = s.S1;
      if (s.C1) document.getElementById('c1').value = s.C1;
      if (s.C2) document.getElementById('c2').value = s.C2;
    } catch {}
  </script>
</body>
</html>
