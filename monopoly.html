<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Monopoly Lay Orbitx</title>
  <meta name="description" content="Promo qualification cash avec Lay Orbitx (monochrome)">
  <meta name="color-scheme" content="dark light">
  <style>
    /* Thème monochrome (noir & blanc) */
    :root{--bg:#FAFAFA;--fg:#0A0A0A;--muted:#6B7280;--card:#FFFFFF;--border:#E5E7EB;--accent:#111;--ok:#16a34a;--warn:#b91c1c}
    .dark{--bg:#0A0A0A;--fg:#F5F5F5;--muted:#9CA3AF;--card:#111;--border:#27272A;--accent:#FFF}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font:14px ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{max-width:960px;margin:0 auto;padding:18px}
    h1{margin:0 0 8px;font-size:22px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
    label{display:block;margin:10px 0 6px}
    input{width:100%;font:inherit;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--fg);outline:none}
    input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,0,0,.07)}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{cursor:pointer;border:1px solid var(--fg);background:var(--fg);color:var(--bg);padding:10px 14px;border-radius:10px;font-weight:700}
    .btn.ghost{background:transparent;color:var(--fg)}
    .sub{color:var(--muted);margin:0 0 10px}
    .center{text-align:center}
    .msg{display:none;margin:12px auto 6px;max-width:520px;padding:8px 12px;border-radius:999px;font-weight:800}
    .ok{color:var(--ok);border:1px solid var(--ok)}
    .warn{color:var(--warn);border:1px solid var(--warn)}
    .muted{color:var(--muted);font-size:13px}
    table{width:100%;border-collapse:collapse;margin-top:14px;font-size:13px}
    th,td{border-top:1px solid var(--border);padding:10px 8px;text-align:left}
    tfoot td{border-top:1px solid var(--border);font-weight:700}
    .footer{margin-top:18px;text-align:center;color:var(--muted);font-size:12px}
    .nav{margin-bottom:10px}
    .nav a{color:inherit;text-decoration:none;border:1px solid var(--border);padding:6px 10px;border-radius:8px}
  </style>
</head>
<body class="dark">
  <div class="wrap">
    <div class="nav">
      <a href="index.html">← Retour Convertisseur</a>
    </div>

    <h1>Monopoly Lay Orbitx</h1>
    <p class="sub">Calcule la **mise LAY optimale** pour une promo de qualification (cash), avec commission Orbitx.</p>

    <div class="card">
      <div class="grid2">
        <div>
          <label>Combien dois-tu jouer pour réaliser les conditions de la promo (€) ?</label>
          <input id="stake" type="number" inputmode="decimal" step="0.01" min="0" value="20">
        </div>
        <div>
          <label>Quelle est la commission d’Orbitx (%) ?</label>
          <input id="commission" type="number" inputmode="decimal" step="0.1" min="0" max="100" value="3">
        </div>
        <div>
          <label>Cote Back FR :</label>
          <input id="back" type="number" inputmode="decimal" step="0.01" min="1.01" value="4.50">
        </div>
        <div>
          <label>Cote Lay Orbitx :</label>
          <input id="lay" type="number" inputmode="decimal" step="0.01" min="1.01" value="3.45">
        </div>
      </div>

      <div class="row">
        <button id="calc" class="btn" type="button">Calculer Promo</button>
        <button id="reset" class="btn ghost" type="button">Réinitialiser</button>
      </div>

      <div id="flag" class="msg center"></div>

      <div id="details" class="center" style="display:none">
        <p>La rentabilité est de <strong id="profit">0,00€</strong> !</p>
        <p class="muted"><em>
          Tu dois jouer : <strong id="stake_back">0,00€</strong> sur la Cote du <strong>BACK Français</strong> ;
          <strong id="stake_lay">0,00€</strong> sur la Cote du <strong>LAY</strong> en BackerStake.<br>
          Il te faudra <strong id="liquidity">0,00€</strong> de liquidités sur Orbitx pour placer le pari.
        </em></p>
        <p class="muted"><strong>N'oublie pas</strong> de cliquer <em>“Je participe”</em> sur la promo (si nécessaire).</p>

        <table>
          <thead>
            <tr><th>Issue</th><th>Cote BACK</th><th>Cote LAY</th><th>Mise</th><th>Résultat net</th></tr>
          </thead>
          <tbody>
            <tr>
              <td>BACK gagne</td>
              <td id="t_back1">–</td>
              <td id="t_lay1">–</td>
              <td id="t_stake1">–</td>
              <td id="t_net1">–</td>
            </tr>
            <tr>
              <td>LAY gagne</td>
              <td id="t_back2">–</td>
              <td id="t_lay2">–</td>
              <td id="t_stake2">–</td>
              <td id="t_net2">–</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="4">Net (égalisé)</td>
              <td id="t_net">–</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <div class="footer">© 2025 – Créé par <strong>Maxim Minutillo</strong> • <em>Ne pas partager</em></div>
  </div>

  <script>
    const fmtEUR = (n) => new Intl.NumberFormat('fr-FR', {style:'currency', currency:'EUR'}).format(n||0);

    function compute() {
      const S = parseFloat(document.getElementById('stake').value.replace(',', '.')) || 0;
      const back = parseFloat(document.getElementById('back').value.replace(',', '.')) || 0;
      const lay  = parseFloat(document.getElementById('lay').value.replace(',', '.')) || 0;
      const commPct = parseFloat(document.getElementById('commission').value.replace(',', '.'));
      const flag = document.getElementById('flag');

      if (!(S>0 && back>1 && lay>1 && commPct>=0)) return;

      const c = (commPct||0)/100;
      const denom = lay - c;
      if (denom <= 0) {
        flag.textContent = "⚠️ Paramètres invalides (cote LAY - commission ≤ 0).";
        flag.className = "msg warn center";
        flag.style.display = "";
        document.getElementById('details').style.display = "none";
        return;
      }

      // Hedging cash: gains nets égaux dans les deux issues
      const layStake   = S * back / denom;
      const liability  = layStake * (lay - 1);
      const netWin     = S * (back - 1) - liability;         // si BACK gagne
      const netLose    = -S + layStake * (1 - c);            // si LAY gagne (après commission)
      const net        = (Math.abs(netWin - netLose) < 1e-6) ? netWin : (netWin + netLose)/2;

      // Bandeau d’état
      flag.textContent = net >= 0 ? "✅ Bravo" : "⚠️ Attention";
      flag.className   = net >= 0 ? "msg ok center" : "msg warn center";
      flag.style.display = "";

      // Détails
      document.getElementById('profit').textContent     = fmtEUR(net);
      document.getElementById('stake_back').textContent = fmtEUR(S);
      document.getElementById('stake_lay').textContent  = fmtEUR(layStake);
      document.getElementById('liquidity').textContent  = fmtEUR(liability);

      // Tableau
      document.getElementById('t_back1').textContent  = back.toFixed(2);
      document.getElementById('t_lay1').textContent   = lay.toFixed(2);
      document.getElementById('t_stake1').textContent = fmtEUR(S);
      document.getElementById('t_net1').textContent   = fmtEUR(netWin);

      document.getElementById('t_back2').textContent  = back.toFixed(2);
      document.getElementById('t_lay2').textContent   = lay.toFixed(2);
      document.getElementById('t_stake2').textContent = fmtEUR(layStake);
      document.getElementById('t_net2').textContent   = fmtEUR(netLose);

      document.getElementById('t_net').textContent    = fmtEUR(net);
      document.getElementById('details').style.display = "";
      // Persist
      localStorage.setItem('monopoly', JSON.stringify({S, back, lay, commPct}));
    }

    document.getElementById('calc').addEventListener('click', compute);
    document.getElementById('reset').addEventListener('click', () => {
      ['stake','commission','back','lay'].forEach(id => {
        if (id==='stake') document.getElementById(id).value = '';
        else if (id==='commission') document.getElementById(id).value = '3';
        else document.getElementById(id).value = '';
      });
      document.getElementById('flag').style.display = "none";
      document.getElementById('details').style.display = "none";
      localStorage.removeItem('monopoly');
    });

    // Restore
    try {
      const s = JSON.parse(localStorage.getItem('monopoly')||'{}');
      if (s.S) document.getElementById('stake').value = s.S;
      if (s.back) document.getElementById('back').value = s.back;
      if (s.lay) document.getElementById('lay').value = s.lay;
      if (s.commPct !== undefined) document.getElementById('commission').value = s.commPct;
    } catch {}
  </script>
</body>
</html>
